# lead template plus core  

Ця документація дозволить легко імплементувати в будь який шаблон все необхідне для запуску лендінгу з можливість прийому заявок (front,back,sql) згідно поставленої задачі.  

### Що потрібно для розгортання поточної реалізації?
Достатньо скопіювати на сервер і система БУДЕ ПРАЦЮВАТИ.  
У разі потреби, базові важливі налаштування можна зробити в load.php

**P.S.:** Система розроблялась для виконання тестового завдання, тому під "_буде працювати_" мається на увазі "_буде працювати в рамках вимог конкретного тестового завдання і навіть трошечки більше_".  

### Що вміє ця система з інтегрованим лендінгом:
- Має гнучкі налаштування та дуже легко розгортається
- Приймає лід з будь якої з двох форм та зберігає до SQLite/MySQL бази
- Суворо та однаково якісно валідує форми на обох сторонах (front & backend)  
- Вимагає від відвідувача вказати максимально валідний телефон та email  
- Надсилає в гугл аналітику та facebook analytics успішну конверсію у випадку успішно отриманої форми  
- Логує усі дії користувача з форми в окрему таблицю  
- Має захист від дублікатів, спаму та DDoS
- Код гарно прокоментований

### Для відстежування конверсій через Google Analitycs та/чи Facebook Pixel
Передайте сторінці id компаній в get параметрах ggl та fbp (як і вимагалось в тз), або вкажіть ці параметри в файлі load.php.   Також, для тонкого налаштування надсилаємих даних, можна змінити дефолтні в include/form.js

#### Для переходу з SQLite на MySQL потрібно:  
- в load.php змінити значення змінної $sql на 'mysql'  
- в db.php вказати налаштування доступу до свого mysql сервера  
- імпортувати вміст mysql.sql в свою mysql базу  

### Що треба зробити, щоб замінити візуальний шаблон, без зміни функціональності?
Додаємо до нового шаблону (в корінь) наступні файли та теки разом з їх вмістом:  
lib/  
include/  
geo/ (ця тека не обов’язкова – це локальні бази визначення ip)  
load.php  
db.php  
form.php  
success.php  
.htaccess  
SQLite.db (в папці include знаходиться запасна пуста копія бази про всяк випадок)  

Всі інші теки та файли окрім вищеназваних – відносяться до front шаблону і їх треба видаляти у випадку якщо необхідно змінити  візуальний шаблон.  
В файлі .htaccess встановлений режим захисту  від читання чутливих файлів, тож можна не хвилюватись про витоки через тимчасові (sql,zip,db,txt) template файли.  

**В новому index.php**  
Додати в футері під js скриптами:
``` php
<?php require_once $_SERVER['DOCUMENT_ROOT'] . "/include/script.php"; ?>
```
Якщо в новому шаблоні відсутня (не використовується) jquery бібліотека, тоді її треба додати над вище озвученим рядком наступним чином:
``` js
<script src="include/jquery-3.7.1.min.js"></script>
```
Додаємо в шапці на самому початку, першим рядком  
``` php
<?php require_once $_SERVER['DOCUMENT_ROOT'] . "/load.php";?>
``` 
Додаємо між тегами <head>тут</head> під всіма іншими css  
``` html
<link rel="stylesheet" href="include/newstyle.css">
``` 
Додати всім полям цільових форм class=form-control або замінити в include/form.js вміст змінної field на інший класс спільний для всіх полів форм, які треба валідувати (це дозволить підсвічувати поля з помилками);  

Додати полям номеру телефону та email додаткові відповідні класи phone та  email;  

Додати (бажано) полю phone (для покращення користувацького досвіду):
``` js
onfocus="if(this.value=='' || this.value=='+' || this.value=='Your Phone')this.value='+'"
 onblur="if(this.value=='' || this.value=='+' || this.value=='Your Phone')this.value=''"
```
Додати кнопкам відправки форм класси sendForm та testEmailButton;  

У разі потреби, базові важливі налаштування можна зробити в load.php  

#### Далі йде найбільша кількість мануальної роботи для якої треба володіти знаннями в області js,php,sql  
Це пов’язано з тим, що форми вірогідно можуть містити різні поля (різну їх кількість та ціль), тому тут звичайно можливо створити автоматичні шаблони, але лише попрацювавши принаймні з кількома подібними задачами і виявивши закономірності. 
Отже:  
- В form.php та include/form.js треба озвучити поля (яким потрібна відправка на сервер та валідація), згідно шаблонів та патернів закладених та описаних в form.js або якихось особистих напрацювань;  
- Якщо в новому шаблоні додались нові поля яких не було раніше в попередньому шаблоні, то система вміє автоматично створювати нові стовбці в базі даних. Це збільшує кількість запитів до бази (на один додатковий). Цю перевірку перед додаванням запису в базу -  можна відключити, але тоді, при зміні шаблона, потрібно вручну додавати нові стовбці в таблиці/бази (що звичайно рекомендується).  
